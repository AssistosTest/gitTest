<!DOCTYPE html>
<html lang="en">
<head>
   
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="documents.html" class="active">Document Model &amp; Editing</a></li>
                        <li><a href="architecture.html">Architecture</a></li>
                        <li><a href="backend.html">Backend</a></li>
                        <li><a href="plugins.html">Plugins</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <div class="doc-layout">
            <aside class="sidebar">
                <h3>Document Management</h3>
                <ul>
                    <li><a href="#overview">Overview</a></li>
                    <li><a href="#data-model">Data Model</a></li>
                    <li><a href="#persistence">Data Persistence</a></li>
                    <li><a href="#doc-info">Document Info</a></li>
                    <li><a href="#toc">Table of Contents</a></li>
                    <li><a href="#comments">Comments</a></li>
                    <li><a href="#references">References</a></li>
                    <li><a href="#advanced-features">Advanced Features</a></li>
                    <li><a href="#other-files">Editing Other Files</a></li>
                </ul>
            </aside>
            <div class="content-wrapper">
                <div class="doc-section" id="overview">
                    <h1>Managing and Editing .md Documents</h1>
                    <p>A core feature of the Explorer agent is its specialized handling of Markdown (<code>.md</code>) files. Instead of treating them as plain text, Explorer parses them into a structured <strong>Document Object Model</strong> (DOM), turning them into interactive, extensible documents with a rich set of features. Any file, however, can be opened in view or edit mode: Markdown gets the structured document experience; all other text/code files use the general editor.</p>
                    <p><strong>Editor capabilities (Markdown documents):</strong></p>
                    <div class="subsection">
                        <p><strong>Add/reorder chapters:</strong> Insert new chapters and rearrange them to reorder; anchors and IDs stay in sync.</p>
                        <p><strong>Add/reorder paragraphs:</strong> Insert paragraphs within chapters and rearrange them while keeping paragraph IDs and commands aligned.</p>
                        <p><strong>Edit titles & metadata:</strong> Update the document title/info text, chapter titles, and paragraph titles/commands without losing structure.</p>
                        <p><strong>Delete content safely:</strong> Remove chapters or paragraphs while related metadata and comments are updated on save.</p>
                        <p><strong>Comments & references:</strong> Add comments at document, chapter, or paragraph level and manage references inline.</p>
                    </div>
                </div>

                <div class="doc-section" id="data-model">
                    <h2>The Document Data Model</h2>
                    <p>When a Markdown file is loaded, it is transformed into a rich, in-memory representation. This process, known as <strong>hydration</strong>, is handled by the <code>DocumentStore</code> service. The <code>hydrateDocumentModel</code> function enriches the document with metadata, comments, references, and other structured data, creating a hierarchical model that the UI components can interact with.</p>
                    <p><strong>Example:</strong> A file with <code>&lt;!--{"achiles-ide-document": {"id": "guide", "title": "My Guide"}}--&gt;</code> and chapter/paragraph comments is hydrated into a document with <code>docId = "guide"</code>, chapters built from comments or headings, and paragraph records carrying <code>text</code> and <code>commands</code>.</p>
                    <h3>Full document example</h3>
<pre><code>&lt;!-- {"achiles-ide-document":{"id":"L2RvY3VtZW50cy9kb2MubWQ=","title":"doc","infoText":"this is example document","comments":{"toc":{"collapsed":false},"tor":{"collapsed":false,"references":[{"id":"1765191283759","type":"journal","authors":"Smith, J. R., & Doe, A. B.","year":2024,"title":"The Evolving Role of Machine Learning in Predictive Modeling.","pages":"112-135","url":"International Journal of Technological Research,"},{"id":"1765191353867","type":"book","authors":"Johnson, K. T.","year":2022,"title":"Principles of Modern Data Structures and Algorithms.","publisher":"Technical Press Inc.","location":"New York, NY."}]}},"version":1,"updatedAt":"2025-12-08T11:02:37.023Z"}} --&gt;
# Demo Document

T
    <footer>
        <div class="container">
        <p>&copy; 2025 <a href="https://github.com/OutfinityResearch/ploinky/blob/master/README.md" target="_blank" rel="noopener noreferrer">Ploinky Project</a>. All rights reserved.</p>
    </div>
</footer>

<div id="docLightbox" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:2000;align-items:center;justify-content:center;padding:2rem;">
    <span data-close style="position:absolute;top:1.5rem;right:2rem;font-size:2rem;color:#fff;cursor:pointer;">&times;</span>
    <img id="docLightboxImage" alt="Document screenshot" style="max-width:90vw;max-height:90vh;border-radius:12px;border:1px solid var(--border-primary);box-shadow:var(--shadow-lg);background:var(--bg-secondary);">
</div>

<script>
    // Theme toggle
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;
    const themes = ['light', 'dark', 'blue'];
        const themeIcons = {
            light: 'ðŸŒ™', // Icon to show for switching to dark
            dark: 'ðŸ”µ',  // Icon to show for switching to blue
            blue: 'â˜€ï¸'   // Icon to show for switching to light
        };

        const applyTheme = (theme) => {
            body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            themeToggle.textContent = themeIcons[theme];
        };
        
        const savedTheme = localStorage.getItem('theme') || 'light';
        applyTheme(savedTheme);
        
        themeToggle.addEventListener('click', () => {
            const currentTheme = body.getAttribute('data-theme');
            const currentIndex = themes.indexOf(currentTheme);
        const nextIndex = (currentIndex + 1) % themes.length;
        const newTheme = themes[nextIndex];
        applyTheme(newTheme);
    });

    // Lightbox for document screenshots
    const docLightbox = document.getElementById('docLightbox');
    const docLightboxImg = document.getElementById('docLightboxImage');
    document.querySelectorAll('.doc-shot').forEach(img => {
        img.addEventListener('click', () => {
            docLightboxImg.src = img.dataset.full || img.src;
            docLightbox.style.display = 'flex';
        });
    });
    docLightbox.addEventListener('click', (e) => {
        if (e.target === docLightbox || e.target.hasAttribute('data-close')) {
            docLightbox.style.display = 'none';
            docLightboxImg.src = '';
        }
    });
</script>
</body>
</html>
